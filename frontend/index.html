<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Madani Maktab - Student Attendance Management</title>
    <link href="style.css" rel="stylesheet" type="text/css" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="container">
            <div class="header-content">
                <div class="header-text">
                    <h1 onclick="showSection('dashboard')" style="cursor: pointer;" title="Go to Dashboard">
                        <i class="fas fa-graduation-cap"></i> Madani Maktab
                    </h1>
                    <p>Student Attendance Management System</p>
                </div>
                <div class="language-selector">
                    <label for="languageSelector"><i class="fas fa-globe"></i></label>
                    <select id="languageSelector" onchange="changeLanguage(this.value)">
                        <option value="en">English</option>
                        <option value="bn">‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ</option>
                    </select>
                </div>
            </div>
        </div>
    </header>

    <!-- Navigation -->
    <nav class="nav">
        <div class="container">
            <div class="nav-container">
                <button class="mobile-menu-toggle" onclick="toggleMobileMenu()">
                    <i class="fas fa-bars"></i>
                </button>
                <ul class="nav-list" id="navList">
                    <li><a href="#" onclick="showSection('dashboard', event)" class="nav-link active">
                        <i class="fas fa-home"></i> Dashboard
                    </a></li>
                    <li><a href="#" onclick="showSection('registration', event)" class="nav-link">
                        <i class="fas fa-user-plus"></i> Register Student
                    </a></li>
                    <li><a href="#" onclick="showSection('attendance', event)" class="nav-link">
                        <i class="fas fa-check-circle"></i> Daily Attendance
                    </a></li>
                    <li><a href="#" onclick="showSection('reports', event)" class="nav-link">
                        <i class="fas fa-chart-bar"></i> Reports
                    </a></li>
                    <li><a href="#" onclick="showSection('teachers', event)" class="nav-link">
                        <i class="fas fa-chalkboard-teacher"></i> Teachers Corner
                    </a></li>
                    <li><a href="#" onclick="showSection('settings', event)" class="nav-link">
                        <i class="fas fa-cog"></i> Settings
                    </a></li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="main">
        <div class="container">
            <!-- Dashboard Section -->
            <section id="dashboard" class="section active">
                <h2>Dashboard</h2>
                
                <!-- Holiday Notice -->
                <div id="holidayNotice" style="display: none;">
                    <!-- Holiday notice will be displayed here -->
                </div>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <i class="fas fa-users"></i>
                        <h3 id="totalStudents">0</h3>
                        <p data-translate="totalStudents">Total Students</p>
                    </div>
                    <div class="stat-card">
                        <i class="fas fa-check"></i>
                        <h3 id="presentToday">0</h3>
                        <p data-translate="presentToday">Present Today</p>
                    </div>
                    <div class="stat-card">
                        <i class="fas fa-times"></i>
                        <h3 id="absentToday">0</h3>
                        <p data-translate="absentToday">Absent Today</p>
                    </div>
                    <div class="stat-card">
                        <i class="fas fa-percentage"></i>
                        <h3 id="attendanceRate">100%</h3>
                        <p data-translate="attendanceRate">Attendance Rate</p>
                    </div>
                    <div class="stat-card" onclick="showInactiveStudentsList()" style="cursor: pointer;">
                        <i class="fas fa-user-slash"></i>
                        <h3 id="inactiveStudents">0</h3>
                        <p data-translate="inactiveStudents">Inactive Students</p>
                    </div>
                </div>
                
                <!-- Class-wise Stats -->
                <div class="class-wise-stats">
                    <h3>Class-wise Information</h3>
                    <div id="classWiseGrid" class="class-stats-grid">
                        <!-- Class-wise statistics will be displayed here -->
                    </div>
                </div>
                <div class="recent-activity">
                    <h3>Today's Attendance Overview</h3>
                    <div id="todayOverview" class="overview-content">
                        <p>No attendance data for today yet.</p>
                    </div>
                </div>
            </section>

            <!-- Student Registration Section -->
            <section id="registration" class="section">
                <h2>Student Management</h2>
                
                <!-- Bulk Import Section (Hidden by default) -->
                <div id="bulkImportSection" class="bulk-import-section" style="display:none;">
                    <div class="bulk-import-header">
                        <h3>üìä Bulk Import Students from CSV</h3>
                        <button onclick="hideBulkImport()" class="btn btn-secondary">
                            <i class="fas fa-arrow-left"></i> Back to List
                        </button>
                    </div>
                    
                    <div class="bulk-import-instructions">
                        <h4>üìã File Format Required:</h4>
                        <div style="background: #e3f2fd; padding: 15px; border-radius: 8px; margin-bottom: 15px; border-left: 4px solid #2196f3;">
                            <p style="margin: 0; color: #1565c0; font-weight: 600;">
                                üí° <strong>Important for Bengali/Unicode text:</strong> Save as <strong>CSV UTF-8</strong> format
                            </p>
                            <p style="margin: 5px 0 0 0; color: #1565c0; font-size: 0.9em;">
                                <strong>Excel:</strong> File ‚Üí Save As ‚Üí Choose <strong>"CSV UTF-8 (Comma delimited) (*.csv)"</strong>
                            </p>
                            <p style="margin: 5px 0 0 0; color: #1565c0; font-size: 0.9em;">
                                <strong>Google Sheets:</strong> File ‚Üí Download ‚Üí Comma-separated values (.csv)
                            </p>
                        </div>
                        <div style="background: #fff3cd; padding: 12px; border-radius: 8px; margin-bottom: 15px; border-left: 4px solid #ffc107;">
                            <p style="margin: 0; color: #856404; font-weight: 600;">
                                üî§ <strong>Bengali/Unicode Support:</strong> Your Bengali text will display correctly if saved as CSV UTF-8
                            </p>
                            <p style="margin: 8px 0 0 0; color: #856404; font-size: 0.9em;">
                                <strong>Example:</strong> Name should look like "‡¶Æ‡ßã‡¶π‡¶æ‡¶Æ‡ßç‡¶Æ‡¶¶ ‡¶Ü‡¶≤‡ßÄ" not "√†¬¶¬Æ√†¬ß‚Äπ√†¬¶¬π√†¬¶¬æ√†¬¶¬Æ√†¬ß√†¬¶¬Æ√†¬¶¬¶ √†¬¶‚Ä†√†¬¶¬≤√†¬ß‚Ç¨"
                            </p>
                        </div>
                        
                        <div style="text-align: center; margin-bottom: 20px;">
                            <button onclick="downloadAllStudentsCSV()" class="btn btn-secondary">
                                <i class="fas fa-download"></i> Download All Students Data
                            </button>
                        </div>
                        <div class="format-table">
                            <table>
                                <thead>
                                    <tr>
                                        <th>id</th>
                                        <th>name</th>
                                        <th>fatherName</th>
                                        <th>rollNumber</th>
                                        <th>mobileNumber</th>
                                        <th>district</th>
                                        <th>upazila</th>
                                        <th>class</th>
                                        <th>registrationDate</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>ST001</td>
                                        <td>Abdullah Rahman</td>
                                        <td>Rahman Ahmed</td>
                                        <td>101</td>
                                        <td>01711234567</td>
                                        <td>Dhaka</td>
                                        <td>Dhanmondi</td>
                                        <td>‡¶™‡ßç‡¶∞‡¶•‡¶Æ ‡¶∂‡ßç‡¶∞‡ßá‡¶£‡¶ø</td>
                                        <td>2025-01-01</td>
                                    </tr>
                                    <tr>
                                        <td>ST002</td>
                                        <td>Fatima Khatun</td>
                                        <td>Karim Uddin</td>
                                        <td>102</td>
                                        <td>01811234567</td>
                                        <td>Dhaka</td>
                                        <td>Gulshan</td>
                                        <td>‡¶¶‡ßç‡¶¨‡¶ø‡¶§‡ßÄ‡¶Ø‡¶º ‡¶∂‡ßç‡¶∞‡ßá‡¶£‡¶ø</td>
                                        <td>2025-01-02</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        <div class="import-notes">
                            <p><strong>‚ö†Ô∏è Important:</strong></p>
                            <ul>
                                <li>First row must be headers (exactly as shown above)</li>
                                <li>All fields are required - no empty cells</li>
                                <li>Students with same ID will be replaced/updated</li>
                                <li>Roll numbers must be unique (except for updates)</li>
                                <li>Class names must match your existing classes</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="bulk-import-upload">
                        <div class="upload-area">
                            <input type="file" id="excelFile" accept=".csv" style="display:none;">
                            <div class="upload-drop-zone" onclick="document.getElementById('excelFile').click()">
                                <i class="fas fa-cloud-upload-alt"></i>
                                <p>Click to select CSV file</p>
                                <p class="file-types">Supports .csv files (Excel saved as CSV)</p>
                            </div>
                        </div>
                        <div class="upload-actions">
                            <button onclick="processExcelFile()" class="btn btn-primary" id="uploadBtn" disabled>
                                <i class="fas fa-upload"></i> Upload & Import Students
                            </button>
                        </div>
                    </div>
                    
                    <div id="importResults" class="import-results" style="display:none;">
                        <!-- Import results will be shown here -->
                    </div>
                </div>
                
                <!-- Students List Container -->
                <div id="studentsListContainer" class="students-management">
                    <!-- Student list will be populated here by JavaScript -->
                </div>
                
                <!-- Student Registration Form (Hidden by default) -->
                <div id="studentRegistrationForm" class="student-form-container" style="display: none;">
                    <div class="form-header">
                        <h3>Register New Student</h3>
                        <button type="button" onclick="hideStudentRegistrationForm()" class="btn btn-secondary btn-small">
                            <i class="fas fa-arrow-left"></i> Back to List
                        </button>
                    </div>
                    
                    <form id="studentForm" class="form">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="studentName">Student Name *</label>
                                <input type="text" id="studentName" required>
                            </div>
                            <div class="form-group">
                                <label for="fatherName">Father's Name *</label>
                                <input type="text" id="fatherName" required>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="rollNumber">Roll Number *</label>
                                <input type="text" id="rollNumber" required placeholder="Enter roll number (e.g., 101, 201)">
                                <small style="color: #666; font-size: 0.8em;">Each roll number must be unique</small>
                            </div>
                            <div class="form-group">
                                <label for="studentClass">Class *</label>
                                <select id="studentClass" required>
                                    <option value="">Select Class</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="district">District *</label>
                                <input type="text" id="district" required>
                            </div>
                            <div class="form-group">
                                <label for="upazila">Sub-district (Upazila) *</label>
                                <input type="text" id="upazila" required>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="mobile">Mobile Number *</label>
                                <input type="tel" id="mobile" required>
                            </div>
                            <div class="form-group">
                                <!-- Empty space for form balance -->
                            </div>
                        </div>
                        <div class="form-actions">
                            <button type="submit" class="btn btn-primary">
                                <i class="fas fa-plus"></i> Register Student
                            </button>
                            <button type="button" onclick="hideStudentRegistrationForm()" class="btn btn-secondary">
                                <i class="fas fa-times"></i> Cancel
                            </button>
                        </div>
                    </form>
                </div>
            </section>

            <!-- Daily Attendance Section -->
            <section id="attendance" class="section">
                <div class="attendance-header">
                    <h2><i class="fas fa-check-circle"></i> Daily Attendance</h2>
                    <div class="attendance-date-selector">
                        <input type="date" id="attendanceDate" max="">
                    </div>
                </div>

                <div class="attendance-controls">
                    <div class="class-filter">
                        <label for="classFilter">Class:</label>
                        <select id="classFilter">
                            <option value="">All Classes</option>
                        </select>
                        <span class="student-count">(<span id="filteredStudentCount">0</span> students)</span>
                    </div>
                    <div class="bulk-actions">
                        <button onclick="markAllPresent()" class="btn btn-success">
                            <i class="fas fa-check-double"></i> Mark All Present
                        </button>
                        <button onclick="showMarkAllAbsentModal()" class="btn btn-danger">
                            <i class="fas fa-user-slash"></i> Mark All Absent
                        </button>
                        <button onclick="markAllNeutral()" class="btn btn-warning">
                            <i class="fas fa-eraser"></i> <span data-translate="markAllNeutral">Clear All</span>
                        </button>
                        <button onclick="copyPreviousDayAttendance()" class="btn btn-secondary">
                            <i class="fas fa-copy"></i> Copy Previous Day
                        </button>
                    </div>
                </div>
                
                <div id="attendanceList" class="attendance-list">
                    <!-- Student attendance rows will be populated here -->
                </div>
                
                <div class="attendance-save-section">
                    <button onclick="saveAttendance()" class="btn btn-success btn-save-attendance">
                        <i class="fas fa-save"></i> Save Attendance
                    </button>
                    <p class="save-note" data-translate="rememberToSaveAttendance">Remember to save attendance after making changes!</p>
                </div>
            </section>

            <!-- Reports Section -->
            <section id="reports" class="section">
                <h2>Attendance Reports</h2>
                
                <!-- Attendance Tracking Calendar Button -->
                <div class="calendar-toggle" style="margin-bottom: 20px; padding: 15px; background: #f8f9fa; border-radius: 8px; border-left: 4px solid #3498db;">
                    <button onclick="showAttendanceCalendar()" class="btn btn-info" style="margin-bottom: 10px;">
                        üìÖ <span data-translate="showAttendanceTrackingCalendar">Show Attendance Tracking Calendar</span>
                    </button>
                    <p style="font-size: 0.9rem; color: #666; margin: 0;">
                        <em>üìä <span data-translate="viewAttendanceStatistics">View which days attendance was taken vs missed this month with summary statistics</span></em>
                    </p>
                </div>
                
                <div class="report-controls">
                    <div id="dateRestrictionNotice" class="date-restriction-notice" style="display: none;">
                        <i class="fas fa-info-circle"></i>
                        <span data-translate="dateRestrictionNotice">Date selection is restricted to academic year period</span>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="reportStartDate">From Date:</label>
                            <input type="date" id="reportStartDate">
                        </div>
                        <div class="form-group">
                            <label for="reportEndDate">To Date:</label>
                            <input type="date" id="reportEndDate">
                        </div>
                    </div>
                    <button onclick="generateReport()" class="btn btn-primary">
                        <i class="fas fa-chart-bar"></i> Generate Report
                    </button>
                    <button onclick="generateFromBeginningReport()" class="btn btn-success" style="margin-left: 10px;">
                        <i class="fas fa-calendar-alt"></i> From Beginning Report
                    </button>
                </div>
                <div id="reportResults" class="report-results">
                    <p data-translate="selectDateRangeToGenerate">Select date range and click "Generate Report" to view attendance data.</p>
                </div>
            </section>

            <!-- Student Detail Section -->
            <section id="student-detail" class="section">
                <div class="student-detail-header">
                    <button onclick="backToReports()" class="btn btn-secondary">
                        <i class="fas fa-arrow-left"></i> Back to Attendance
                    </button>
                    <h2 id="studentDetailTitle">Student Details</h2>
                </div>
                <div id="studentDetailContent" class="student-detail-content">
                    <!-- Student details will be loaded here -->
                </div>
            </section>

            <!-- Teachers Corner Section (replaces Education) -->
            <section id="teachers" class="section">
                <h2>Teachers Corner</h2>
                <div class="education-content">
                    <div class="education-header">
                        <h3>Book Progress Management</h3>
                        <div class="education-actions">
                            <button id="showAddBookFormBtn" class="btn btn-primary">
                                <i class="fas fa-plus"></i> Add New Book
                            </button>
                            <button onclick="showDeleteAllEducationModal()" class="btn btn-danger">
                                <i class="fas fa-trash-alt"></i> Delete All Data
                            </button>
                        </div>
                    </div>

                    <div class="book-form-container" id="teachersControlPanel">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="teachersClassSelect">Class</label>
                                <select id="teachersClassSelect" onchange="selectTeachersClass()">
                                    <option value="">All Classes</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <div class="book-progress-list">
                        <div class="stats-grid" style="margin-bottom: 20px;">
                            <div class="stat-card">
                                <i class="fas fa-users"></i>
                                <h3 id="teachersTotalStudents">0</h3>
                                <p>Total Students</p>
                            </div>
                            <div class="stat-card">
                                <i class="fas fa-user-check"></i>
                                <h3 id="teachersPresentToday">0</h3>
                                <p>Present Today</p>
                            </div>
                            <div class="stat-card">
                                <i class="fas fa-user-times"></i>
                                <h3 id="teachersAbsentToday">0</h3>
                                <p>Absent Today</p>
                            </div>
                            <div class="stat-card">
                                <i class="fas fa-percentage"></i>
                                <h3 id="teachersAttendanceRate">0%</h3>
                                <p>Attendance Rate</p>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group" style="flex:2;">
                                <label>Students</label>
                                <div id="teachersStudentList"></div>
                            </div>
                            <div class="form-group" style="flex:3;">
                                <label>Class Book Progress</label>
                                <div id="teachersProgressList" class="books-grid"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Progress History Modal for Teachers Corner -->
            <div id="teachersHistoryModal" class="modal" style="display:none;">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3 id="teachersHistoryTitle">Progress History</h3>
                        <button type="button" onclick="closeProgressHistoryModal()" class="btn btn-secondary btn-small">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <div class="form">
                        <div id="teachersHistoryBody" class="item-list"></div>
                    </div>
                </div>
            </div>

            <!-- Settings Section -->
            <section id="settings" class="section">
                <h2><i class="fas fa-cog"></i> Settings</h2>
                
                <div class="settings-tabs">
                    <button class="tab-button active" onclick="openSettingsTab(event, 'general')">
                        <i class="fas fa-cogs"></i> General
                    </button>
                    <button class="tab-button" onclick="openSettingsTab(event, 'academic')">
                        <i class="fas fa-school"></i> Academic
                    </button>
                    <button class="tab-button" onclick="openSettingsTab(event, 'books')">
                        <i class="fas fa-book"></i> Book Management
                    </button>
                    <button class="tab-button" onclick="openSettingsTab(event, 'data')">
                        <i class="fas fa-database"></i> Data Management
                    </button>
                </div>

                <!-- General Tab -->
                <div id="general" class="tab-content active">
                    <h3>Application Settings</h3>
                    <div class="setting-group">
                        <label for="appNameInput">Application Name</label>
                        <p class="help-text">Change the name displayed in the header and title.</p>
                        <div class="input-group">
                            <input type="text" id="appNameInput" value="Madani Maktab">
                            <button class="btn btn-primary" onclick="saveAppName()">
                                <i class="fas fa-save"></i> Save
                            </button>
                        </div>
                    </div>
                    
                    <h3>Hijri Date Settings</h3>
                    <div class="setting-group">
                        <label for="hijriAdjustment">Hijri Date Adjustment</label>
                        <p class="help-text">Adjust the calculated Hijri date for local moon sightings.</p>
                        <select id="hijriAdjustment" onchange="updateHijriAdjustment()">
                            <option value="0">No Adjustment (Default)</option>
                            <option value="1">+1 Day (Ahead)</option>
                            <option value="-1">-1 Day (Behind)</option>
                        </select>
                        <div class="hijri-preview" style="margin-top: 15px;">
                            <strong>Current Date Preview:</strong>
                            <div id="hijriPreview" class="hijri-date-display"></div>
                        </div>
                    </div>
                </div>

                <!-- Academic Tab -->
                <div id="academic" class="tab-content">
                    <h3>Academic Management</h3>
                    <div class="setting-group">
                        <label for="academicYearStartInput">Academic Year Start Date</label>
                        <p class="help-text">Used for reports and date restrictions.</p>
                        <div class="input-group">
                            <input type="date" id="academicYearStartInput">
                            <button class="btn btn-primary" onclick="saveAcademicYearStart()">
                                <i class="fas fa-calendar-check"></i> Set Start Date
                            </button>
                            <button class="btn btn-secondary" onclick="clearAcademicYearStart()">
                                <i class="fas fa-times"></i> Clear
                            </button>
                        </div>
                        <div id="currentAcademicYearDisplay" style="display: none; margin-top: 10px; padding: 8px; background: #e8f5e8; border-radius: 4px; color: #27ae60;">
                            <i class="fas fa-check-circle"></i>
                            <span>Current academic year starts from: <strong id="academicYearStartDisplay"></strong></span>
                        </div>
                    </div>
                    
                    <div class="setting-group">
                        <label for="newClassName">Manage Classes</label>
                        <p class="help-text">Add or remove classes from the system.</p>
                        <div class="input-group">
                            <input type="text" id="newClassName" placeholder="Enter new class name">
                            <button class="btn btn-primary" onclick="addClass()">
                                <i class="fas fa-plus"></i> Add Class
                            </button>
                        </div>
                        <div class="item-list" id="classesList">
                            <!-- Classes will be displayed here -->
                        </div>
                    </div>
                    
                    <div class="setting-group">
                        <label>Holiday Management</label>
                        <p class="help-text">Add official holidays. Attendance cannot be taken on these days.</p>
                        <div class="input-group" style="margin-bottom: 10px;">
                            <input type="text" id="holidayName" placeholder="Holiday Name (e.g., Eid-ul-Fitr)">
                        </div>
                        <div class="input-group">
                            <input type="date" id="holidayStartDate" title="Start Date">
                            <input type="date" id="holidayEndDate" title="End Date (optional)">
                            <button class="btn btn-primary" onclick="addHoliday()">
                                <i class="fas fa-calendar-plus"></i> Add Holiday
                            </button>
                        </div>
                        <div class="item-list" id="holidaysList">
                            <!-- Holidays will be displayed here -->
                        </div>
                    </div>
                </div>
                
                <!-- Book Management Tab -->
                <div id="books" class="tab-content">
                    <h3>Book Management</h3>
                    <div class="setting-group">
                        <label for="newBookName">Add New Book</label>
                        <p class="help-text">Add books that students will study.</p>
                        <div class="input-group">
                            <input type="text" id="newBookName" placeholder="Enter new book name">
                            <select id="newBookClass">
                                <option value="">All Classes</option>
                                <!-- Class options will be populated dynamically -->
                            </select>
                            <button class="btn btn-primary" onclick="addBook()">
                                <i class="fas fa-plus"></i> Add Book
                            </button>
                        </div>
                        <div class="item-list" id="settingsBooksList">
                            <!-- Books will be displayed here -->
                        </div>
                    </div>

                    <div class="setting-group">
                        <h4 style="margin-bottom:10px;">Book-Class Assignment</h4>
                        <p class="help-text">Assign existing books to a specific class for tracking.</p>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="bookClass">Class</label>
                                <select id="bookClass">
                                    <option value="">Select Class</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="bookSubject">Subject</label>
                                <input type="text" id="bookSubject" placeholder="e.g., Mathematics, Science, English">
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="bookName">Book</label>
                                <select id="bookName">
                                    <option value="">Select Book</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="totalPages">Total Pages</label>
                                <input type="number" id="totalPages" placeholder="e.g., 120" min="1">
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="completedPages">Completed Pages</label>
                                <input type="number" id="completedPages" placeholder="e.g., 0" min="0" value="0">
                            </div>
                            <div class="form-group">
                                <label for="bookNotes">Notes</label>
                                <textarea id="bookNotes" placeholder="Any additional notes about the book progress"></textarea>
                            </div>
                        </div>
                        <div class="form-actions">
                            <button class="btn btn-primary" onclick="addBookProgress()">
                                <i class="fas fa-save"></i> Assign Book to Class
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Data Management Tab -->
                <div id="data" class="tab-content">
                    <div class="danger-zone">
                        <h4><i class="fas fa-exclamation-triangle"></i> Danger Zone</h4>
                        <p>The actions below are permanent and cannot be undone. Please proceed with caution.</p>
                        <button class="btn btn-danger" onclick="showResetAttendanceModal()">
                            <i class="fas fa-trash-alt"></i> Reset Attendance History
                        </button>
                    </div>
                    
                    <div class="setting-group" style="margin-top: 25px;">
                        <label>Import / Export Data</label>
                        <p class="help-text">Manage your student data in bulk.</p>
                        <button class="btn btn-secondary" onclick="showBulkImport()">
                            <i class="fas fa-file-import"></i> Bulk Import Students
                        </button>
                        <button class="btn btn-secondary" onclick="downloadAllStudentsCSV()">
                            <i class="fas fa-file-export"></i> Export All Data
                        </button>
                    </div>
                </div>
            </section>
        </div>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <p>&copy; 2024 Madani Maktab. All rights reserved.</p>
        </div>
    </footer>

    <!-- Modal for notifications -->
    <div id="modal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal()">&times;</span>
            <div id="modalBody"></div>
        </div>
    </div>

    <!-- Bulk Absent Modal -->
    <div id="bulkAbsentModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeBulkAbsentModal()">&times;</span>
            <h3>Mark All Students Absent</h3>
            <div class="bulk-absent-form">
                <label for="bulkAbsentReason">Reason for absence (applies to all students):</label>
                <input type="text" id="bulkAbsentReason" placeholder="e.g., School holiday, Strike, etc." maxlength="100">
                <div class="modal-buttons">
                    <button onclick="confirmMarkAllAbsent()" class="btn btn-danger">
                        <i class="fas fa-times-circle"></i> Mark All Absent
                    </button>
                    <button onclick="closeBulkAbsentModal()" class="btn btn-secondary">
                        <i class="fas fa-times"></i> Cancel
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Reset Attendance Modal -->
    <div id="resetAttendanceModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeResetAttendanceModal()">&times;</span>
            <h3 style="color: #dc3545;"><i class="fas fa-exclamation-triangle"></i> Reset Attendance History</h3>
            <div class="reset-attendance-form">
                <div style="background: #f8d7da; border: 1px solid #f5c6cb; border-radius: 6px; padding: 15px; margin-bottom: 20px;">
                    <p style="color: #721c24; margin-bottom: 10px;"><strong>‚ö†Ô∏è Warning: This action cannot be undone!</strong></p>
                    <p style="color: #721c24; margin-bottom: 10px;">This will permanently delete:</p>
                    <ul style="color: #721c24; margin-bottom: 0;">
                        <li>All attendance records for all students</li>
                        <li>All saved attendance dates</li>
                        <li>All attendance history from the calendar</li>
                    </ul>
                </div>
                <p style="margin-bottom: 15px;">Type <strong>"RESET"</strong> to confirm:</p>
                <input type="text" id="resetConfirmationInput" placeholder="Type RESET to confirm" style="margin-bottom: 15px; width: 100%;">
                <div class="modal-buttons">
                    <button onclick="confirmResetAttendance()" class="btn btn-danger" id="confirmResetBtn" disabled>
                        <i class="fas fa-trash-alt"></i> Reset All Attendance
                    </button>
                    <button onclick="closeResetAttendanceModal()" class="btn btn-secondary">
                        <i class="fas fa-times"></i> Cancel
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Book Management Edit Modal -->
    <div id="bookManagementEditModal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Edit Book</h3>
                <button type="button" onclick="closeBookManagementEditModal()" class="btn btn-secondary btn-small">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <form id="bookManagementEditForm" class="form">
                <input type="hidden" id="bookManagementEditId">
                <div class="form-row">
                    <div class="form-group">
                        <label for="bookManagementEditName">Book Name *</label>
                        <input type="text" id="bookManagementEditName" required>
                    </div>
                    <div class="form-group">
                        <label for="bookManagementEditClass">Class</label>
                        <select id="bookManagementEditClass">
                            <option value="">All Classes</option>
                            <option value="1">‡¶™‡ßç‡¶∞‡¶•‡¶Æ ‡¶∂‡ßç‡¶∞‡ßá‡¶£‡¶ø</option>
                            <option value="2">‡¶¶‡ßç‡¶¨‡¶ø‡¶§‡ßÄ‡¶Ø‡¶º ‡¶∂‡ßç‡¶∞‡ßá‡¶£‡¶ø</option>
                            <option value="3">‡¶§‡ßÉ‡¶§‡ßÄ‡¶Ø‡¶º ‡¶∂‡ßç‡¶∞‡ßá‡¶£‡¶ø</option>
                            <option value="4">‡¶ö‡¶§‡ßÅ‡¶∞‡ßç‡¶• ‡¶∂‡ßç‡¶∞‡ßá‡¶£‡¶ø</option>
                            <option value="5">‡¶™‡¶û‡ßç‡¶ö‡¶Æ ‡¶∂‡ßç‡¶∞‡ßá‡¶£‡¶ø</option>
                        </select>
                    </div>
                </div>
                <div class="form-actions">
                    <button type="submit" class="btn btn-primary">
                        <i class="fas fa-save"></i> Save Changes
                    </button>
                    <button type="button" onclick="closeBookManagementEditModal()" class="btn btn-secondary">
                        Cancel
                    </button>
                </div>
            </form>
        </div>
    </div>

    <script type="module" src="translations.js"></script>
    <script src="modules/hijri.js" type="module"></script>
    <script type="module" src="modules/main.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // If Teachers Corner is visible at load, initialize it
            const teachersSection = document.getElementById('teachers');
            if (teachersSection && teachersSection.classList.contains('active') && typeof showTeachersCorner === 'function') {
                showTeachersCorner();
            }
        });
    </script>
</body>
</html>
